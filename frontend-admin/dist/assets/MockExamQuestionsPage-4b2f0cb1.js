import{_ as ne,u as ie,r as u,a as se,i as ue,b as i,G as re,o as _,c as V,d as v,e as t,w as a,j as q,E as f,g as s,J as L,K as j,t as d,M as D,N as de,L as Q,k as R,l as me,q as pe,I as _e}from"./index-e5bf8409.js";const ce={class:"mock-exam-container"},ge={class:"page-header"},ve={key:0,class:"stats-info"},fe={class:"exam-title"},ye={key:0,class:"pagination"},xe={__name:"MockExamQuestionsPage",setup(be){const I=ie(),m=u(0),w=u(!1),C=u(!1),y=u(!1),z=u("create"),S=u(null),x=u([]),E=u(1),M=u(10),b=u(0),n=se({id:null,title:"",level:1,exam_type:"mock",time_limit:120,question_count:30,description:""}),A={title:[{required:!0,message:"请输入考试名称",trigger:"blur"},{min:2,max:200,message:"长度在 2 到 200 个字符",trigger:"blur"}],level:[{required:!0,message:"请选择HSK等级",trigger:"change"}],exam_type:[{required:!0,message:"请选择考试类型",trigger:"change"}],time_limit:[{required:!0,message:"请输入时间限制",trigger:"blur"}],question_count:[{required:!0,message:"请输入题目数量",trigger:"blur"}]},c=async()=>{w.value=!0;try{const o={page:E.value,page_size:M.value};m.value>0&&(o.level=m.value);const e=await q.getExamSets(o);e.data.results?(x.value=e.data.results,b.value=e.data.count):Array.isArray(e.data)&&(x.value=e.data,b.value=e.data.length),console.log("加载模拟考试列表:",x.value.length,"套")}catch(o){console.error("加载模拟考试列表失败:",o),f.error("加载失败")}finally{w.value=!1}},H=(o,e=null)=>{z.value=o,o==="create"?Object.assign(n,{id:null,title:"",level:m.value>0?m.value:1,exam_type:"mock",time_limit:120,question_count:30,description:""}):Object.assign(n,{id:e.id,title:e.title,level:e.level,exam_type:e.exam_type||"mock",time_limit:e.time_limit,question_count:e.question_count,description:e.description||""}),y.value=!0,setTimeout(()=>{var r;(r=S.value)==null||r.clearValidate()},0)},O=async()=>{if(S.value)try{await S.value.validate(),C.value=!0;const o={title:n.title,level:n.level,exam_type:n.exam_type,time_limit:n.time_limit,question_count:n.question_count,description:n.description};z.value==="create"?(await q.createExamSet(o),f.success("创建成功")):(await q.updateExamSet(n.id,o),f.success("更新成功")),y.value=!1,c()}catch(o){o!=="cancel"&&(console.error("提交失败:",o),f.error("操作失败"))}finally{C.value=!1}},F=async o=>{try{await _e.confirm(`确定要删除"${o.title}"吗？删除后无法恢复！`,"警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),await q.deleteExamSet(o.id),f.success("删除成功"),c()}catch(e){e!=="cancel"&&(console.error("删除失败:",e),f.error("删除失败"))}},G=o=>{I.push(`/exam-set/${o.id}/questions`)},J=o=>o?new Date(o).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}):"-",W=o=>({real:"danger",mock:"warning",sample:"success",practice:"info"})[o]||"info",X=o=>({real:"真题",mock:"模拟题",sample:"样卷",practice:"练习题"})[o]||"未知";return ue(()=>{c()}),(o,e)=>{const r=i("el-button"),K=i("el-radio-button"),Y=i("el-radio-group"),U=i("el-tag"),$=i("el-card"),p=i("el-table-column"),B=i("el-icon"),Z=i("el-table"),ee=i("el-pagination"),te=i("el-empty"),h=i("el-input"),g=i("el-form-item"),k=i("el-option"),N=i("el-select"),P=i("el-input-number"),le=i("el-form"),ae=i("el-dialog"),oe=re("loading");return _(),V("div",ce,[v("div",ge,[e[13]||(e[13]=v("h2",null,"模拟考试题目管理",-1)),t(r,{type:"primary",icon:"Plus",onClick:e[0]||(e[0]=l=>H("create"))},{default:a(()=>e[12]||(e[12]=[s(" 创建新模拟考试 ")])),_:1,__:[12]})]),t($,{class:"level-selector-card"},{default:a(()=>[t(Y,{modelValue:m.value,"onUpdate:modelValue":e[1]||(e[1]=l=>m.value=l),size:"large",onChange:c},{default:a(()=>[t(K,{value:0},{default:a(()=>e[14]||(e[14]=[s("全部等级")])),_:1,__:[14]}),(_(),V(L,null,j(6,l=>t(K,{key:l,value:l},{default:a(()=>[s(" HSK "+d(l)+"级 ",1)]),_:2},1032,["value"])),64))]),_:1},8,["modelValue"]),m.value?(_(),V("div",ve,[t(U,{type:"info",size:"large"},{default:a(()=>[s(" 当前显示: HSK"+d(m.value)+"级 模拟考试 ("+d(b.value)+" 套) ",1)]),_:1})])):D("",!0)]),_:1}),t($,{class:"table-card"},{default:a(()=>[de((_(),Q(Z,{data:x.value,style:{width:"100%"},stripe:""},{default:a(()=>[t(p,{prop:"id",label:"ID",width:"80"}),t(p,{prop:"title",label:"考试名称","min-width":"250"},{default:a(({row:l})=>[v("div",fe,[t(U,{type:"warning",size:"small",style:{"margin-right":"8px"}},{default:a(()=>[s(" HSK"+d(l.level),1)]),_:2},1024),v("span",null,d(l.title),1)])]),_:1}),t(p,{label:"考试类型",width:"120"},{default:a(({row:l})=>[t(U,{type:W(l.exam_type)},{default:a(()=>[s(d(X(l.exam_type)),1)]),_:2},1032,["type"])]),_:1}),t(p,{prop:"question_count",label:"题目数量",width:"120"},{default:a(({row:l})=>[t(B,null,{default:a(()=>[t(R(me))]),_:1}),s(" "+d(l.question_count||0)+" 题 ",1)]),_:1}),t(p,{prop:"time_limit",label:"时间限制",width:"120"},{default:a(({row:l})=>[t(B,null,{default:a(()=>[t(R(pe))]),_:1}),s(" "+d(l.time_limit)+" 分钟 ",1)]),_:1}),t(p,{prop:"description",label:"描述","min-width":"200","show-overflow-tooltip":""}),t(p,{prop:"created_at",label:"创建时间",width:"180"},{default:a(({row:l})=>[s(d(J(l.created_at)),1)]),_:1}),t(p,{label:"操作",width:"250",fixed:"right"},{default:a(({row:l})=>[t(r,{size:"small",type:"primary",onClick:T=>H("edit",l)},{default:a(()=>e[15]||(e[15]=[s(" 编辑 ")])),_:2,__:[15]},1032,["onClick"]),t(r,{size:"small",type:"info",onClick:T=>G(l)},{default:a(()=>e[16]||(e[16]=[s(" 管理题目 ")])),_:2,__:[16]},1032,["onClick"]),t(r,{size:"small",type:"danger",onClick:T=>F(l)},{default:a(()=>e[17]||(e[17]=[s(" 删除 ")])),_:2,__:[17]},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[oe,w.value]]),b.value>0?(_(),V("div",ye,[t(ee,{"current-page":E.value,"onUpdate:currentPage":e[2]||(e[2]=l=>E.value=l),"page-size":M.value,"onUpdate:pageSize":e[3]||(e[3]=l=>M.value=l),"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next, jumper",total:b.value,onCurrentChange:c,onSizeChange:c},null,8,["current-page","page-size","total"])])):D("",!0),!w.value&&x.value.length===0?(_(),Q(te,{key:1,description:"暂无模拟考试题目"})):D("",!0)]),_:1}),t(ae,{modelValue:y.value,"onUpdate:modelValue":e[11]||(e[11]=l=>y.value=l),title:z.value==="create"?"创建模拟考试":"编辑模拟考试",width:"600px"},{footer:a(()=>[t(r,{onClick:e[10]||(e[10]=l=>y.value=!1)},{default:a(()=>e[20]||(e[20]=[s("取消")])),_:1,__:[20]}),t(r,{type:"primary",onClick:O,loading:C.value},{default:a(()=>e[21]||(e[21]=[s(" 确定 ")])),_:1,__:[21]},8,["loading"])]),default:a(()=>[t(le,{model:n,rules:A,ref_key:"formRef",ref:S,"label-width":"100px"},{default:a(()=>[t(g,{label:"考试名称",prop:"title"},{default:a(()=>[t(h,{modelValue:n.title,"onUpdate:modelValue":e[4]||(e[4]=l=>n.title=l),placeholder:"例如：HSK3真题试卷 (H31550)",maxlength:"200","show-word-limit":""},null,8,["modelValue"])]),_:1}),t(g,{label:"HSK等级",prop:"level"},{default:a(()=>[t(N,{modelValue:n.level,"onUpdate:modelValue":e[5]||(e[5]=l=>n.level=l),placeholder:"请选择HSK等级"},{default:a(()=>[(_(),V(L,null,j(6,l=>t(k,{key:l,label:`HSK ${l}级`,value:l},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1}),t(g,{label:"考试类型",prop:"exam_type"},{default:a(()=>[t(N,{modelValue:n.exam_type,"onUpdate:modelValue":e[6]||(e[6]=l=>n.exam_type=l),placeholder:"请选择考试类型"},{default:a(()=>[t(k,{label:"真题",value:"real"}),t(k,{label:"模拟题",value:"mock"}),t(k,{label:"样卷",value:"sample"}),t(k,{label:"练习题",value:"practice"})]),_:1},8,["modelValue"])]),_:1}),t(g,{label:"时间限制",prop:"time_limit"},{default:a(()=>[t(P,{modelValue:n.time_limit,"onUpdate:modelValue":e[7]||(e[7]=l=>n.time_limit=l),min:10,max:300,step:5},null,8,["modelValue"]),e[18]||(e[18]=v("span",{style:{"margin-left":"10px"}},"分钟",-1))]),_:1,__:[18]}),t(g,{label:"题目数量",prop:"question_count"},{default:a(()=>[t(P,{modelValue:n.question_count,"onUpdate:modelValue":e[8]||(e[8]=l=>n.question_count=l),min:1,max:200,step:1},null,8,["modelValue"]),e[19]||(e[19]=v("span",{style:{"margin-left":"10px"}},"题",-1))]),_:1,__:[19]}),t(g,{label:"描述"},{default:a(()=>[t(h,{modelValue:n.description,"onUpdate:modelValue":e[9]||(e[9]=l=>n.description=l),type:"textarea",rows:4,placeholder:"请输入考试描述",maxlength:"500","show-word-limit":""},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}},Ve=ne(xe,[["__scopeId","data-v-bc9cc406"]]);export{Ve as default};
