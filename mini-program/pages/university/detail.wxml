<!-- é«˜æ ¡è¯¦æƒ…é¡µé¢ -->
<view class="university-detail-container">
  <!-- åŠ è½½çŠ¶æ€ -->
  <view class="loading-container" wx:if="{{loading}}">
    <view class="loading-spinner"></view>
    <text class="loading-text">åŠ è½½ä¸­...</text>
  </view>

  <!-- é”™è¯¯çŠ¶æ€ -->
  <view class="error-container" wx:elif="{{error}}">
    <view class="error-icon">âš ï¸</view>
    <text class="error-text">{{errorMsg || 'åŠ è½½å¤±è´¥'}}</text>
    <button class="retry-button" bindtap="fetchUniversityDetail">é‡è¯•</button>
  </view>

  <!-- é«˜æ ¡è¯¦æƒ…å†…å®¹ -->
  <block wx:else>
    <!-- é«˜æ ¡å¤´éƒ¨ä¿¡æ¯ -->
    <view class="university-header">
      <view class="university-banner-gradient"></view>
      <view class="university-badge-container">
        <text class="university-badge-emoji">ğŸ“</text>
      </view>
      
      <view class="university-title-container">
        <text class="university-name">{{university.name}}</text>
        <text class="university-english-name">{{university.englishName}}</text>
        
        <view class="university-tags">
          <text class="tag tag-985" wx:if="{{university.is985}}">985å·¥ç¨‹</text>
          <text class="tag tag-211" wx:if="{{university.is211}}">211å·¥ç¨‹</text>
          <text class="tag tag-double" wx:if="{{university.isDoubleFirstClass}}">åŒä¸€æµ</text>
        </view>
      </view>
    </view>

    <!-- é«˜æ ¡å¿«é€Ÿä¿¡æ¯ -->
    <view class="quick-info">
      <view class="info-item">
        <text class="info-icon">ğŸ“</text>
        <text class="info-text">{{university.region}}</text>
      </view>
      <view class="info-item">
        <text class="info-icon">ğŸ“…</text>
        <text class="info-text">{{university.establishYear}}å¹´å»ºæ ¡</text>
      </view>
      <view class="info-item">
        <text class="info-icon">ğŸ†</text>
        <text class="info-text">å…¨å›½æ’å {{university.ranking}}</text>
      </view>
    </view>

    <!-- å†…å®¹æ ‡ç­¾é¡µ -->
    <view class="tab-container">
      <view 
        class="tab-item {{currentTab === 'info' ? 'active' : ''}}" 
        data-tab="info" 
        bindtap="switchTab"
      >
        åŸºæœ¬ä¿¡æ¯
      </view>
      <view 
        class="tab-item {{currentTab === 'departments' ? 'active' : ''}}" 
        data-tab="departments" 
        bindtap="switchTab"
      >
        é™¢ç³»ä¸“ä¸š
      </view>
      <view 
        class="tab-item {{currentTab === 'admission' ? 'active' : ''}}" 
        data-tab="admission" 
        bindtap="switchTab"
      >
        æ‹›ç”Ÿæ”¿ç­–
      </view>
      <view 
        class="tab-item {{currentTab === 'scenery' ? 'active' : ''}}" 
        data-tab="scenery" 
        bindtap="switchTab"
      >
        æ ¡å›­é£å…‰
      </view>
    </view>

    <!-- å†…å®¹åŒºåŸŸ -->
    <view class="content-container">
      <!-- åŸºæœ¬ä¿¡æ¯ -->
      <view class="content-section" wx:if="{{currentTab === 'info'}}">
        <view class="info-card">
          <view class="card-title">å­¦æ ¡ç®€ä»‹</view>
          <view class="card-content">
            <text class="description-text">{{university.description || 'æš‚æ— ç®€ä»‹ä¿¡æ¯'}}</text>
          </view>
        </view>
        
        <view class="info-card">
          <view class="card-title">è”ç³»æ–¹å¼</view>
          <view class="card-content">
            <view class="contact-item">
              <text class="contact-icon">ğŸŒ</text>
              <text class="contact-text" bindtap="openWebsite" data-url="{{university.website}}">{{university.website}}</text>
            </view>
            <view class="contact-item" wx:if="{{university.phone}}">
              <text class="contact-icon">ğŸ“</text>
              <text class="contact-text" bindtap="makePhoneCall" data-phone="{{university.phone}}">{{university.phone}}</text>
            </view>
            <view class="contact-item" wx:if="{{university.email}}">
              <text class="contact-icon">ğŸ“§</text>
              <text class="contact-text">{{university.email}}</text>
            </view>
            <view class="contact-item" wx:if="{{university.address}}">
              <text class="contact-icon">ğŸ“«</text>
              <text class="contact-text">{{university.address}}</text>
            </view>
          </view>
        </view>
      </view>

      <!-- é™¢ç³»ä¸“ä¸š -->
      <view class="content-section" wx:if="{{currentTab === 'departments'}}">
        <view class="info-card" wx:if="{{departments.length > 0}}">
          <block wx:for="{{departments}}" wx:key="id">
            <view class="department-item">
              <view class="department-name">{{item.name}}</view>
              <view class="major-list">
                <text class="major-item" wx:for="{{item.majors}}" wx:for-item="major" wx:key="id">{{major.name}}</text>
              </view>
            </view>
          </block>
        </view>
        <view class="empty-container" wx:else>
          <text class="empty-icon">ğŸ“</text>
          <text class="empty-text">æš‚æ— é™¢ç³»ä¸“ä¸šä¿¡æ¯</text>
        </view>
      </view>

      <!-- æ‹›ç”Ÿæ”¿ç­– -->
      <view class="content-section" wx:if="{{currentTab === 'admission'}}">
        <view class="info-card" wx:if="{{admission}}">
          <view class="admission-section">
            <view class="admission-title">æ‹›ç”Ÿè®¡åˆ’</view>
            <text class="admission-text">{{admission.plan || 'æš‚æ— æ‹›ç”Ÿè®¡åˆ’ä¿¡æ¯'}}</text>
          </view>
          
          <view class="admission-section">
            <view class="admission-title">æ‹›ç”Ÿè¦æ±‚</view>
            <text class="admission-text">{{admission.requirements || 'æš‚æ— æ‹›ç”Ÿè¦æ±‚ä¿¡æ¯'}}</text>
          </view>
          
          <view class="admission-section">
            <view class="admission-title">å½•å–æ”¿ç­–</view>
            <text class="admission-text">{{admission.policy || 'æš‚æ— å½•å–æ”¿ç­–ä¿¡æ¯'}}</text>
          </view>
          
          <view class="admission-section" wx:if="{{admission.links && admission.links.length > 0}}">
            <view class="admission-title">ç›¸å…³é“¾æ¥</view>
            <view class="admission-links">
              <view 
                class="admission-link" 
                wx:for="{{admission.links}}" 
                wx:key="index"
                bindtap="openWebsite"
                data-url="{{item.url}}"
              >
                <text>{{item.title}}</text>
                <text class="link-icon">ğŸ”—</text>
              </view>
            </view>
          </view>
        </view>
        <view class="empty-container" wx:else>
          <text class="empty-icon">ğŸ“‹</text>
          <text class="empty-text">æš‚æ— æ‹›ç”Ÿæ”¿ç­–ä¿¡æ¯</text>
        </view>
      </view>

      <!-- æ ¡å›­é£å…‰ -->
      <view class="content-section" wx:if="{{currentTab === 'scenery'}}">
        <view class="scenery-grid" wx:if="{{sceneryImages && sceneryImages.length > 0}}">
          <view 
            class="scenery-item" 
            wx:for="{{sceneryImages}}" 
            wx:key="index"
            bindtap="previewImage"
            data-index="{{index}}"
          >
            <image class="scenery-image" src="{{item.url}}" mode="aspectFill"></image>
            <text class="scenery-caption">{{item.caption}}</text>
          </view>
        </view>
        <view class="empty-container" wx:else>
          <text class="empty-icon">ğŸ«</text>
          <text class="empty-text">æš‚æ— æ ¡å›­é£å…‰å›¾ç‰‡</text>
        </view>
      </view>
    </view>

    <!-- åº•éƒ¨æ“ä½œæ  -->
    <view class="action-bar">
      <button class="action-button share-button" open-type="share">
        <text class="action-icon">ğŸ“¤</text>
        <text>åˆ†äº«</text>
      </button>
      <button class="action-button favorite-button" bindtap="toggleFavorite">
        <text class="action-icon">{{isFavorite ? 'â¤ï¸' : 'ğŸ¤'}}</text>
        <text>{{isFavorite ? 'å·²æ”¶è—' : 'æ”¶è—'}}</text>
      </button>
      <button class="action-button website-button" bindtap="openWebsite" data-url="{{university.website}}">
        <text class="action-icon">ğŸŒ</text>
        <text>å®˜ç½‘</text>
      </button>
    </view>
  </block>
</view> 