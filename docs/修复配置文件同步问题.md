# 修复配置文件同步问题

## 问题确认

容器重启后，配置仍然显示：
```
ssl_certificate /etc/letsencrypt/live/tangxinhao.online/fullchain.pem;
```

但主机上的配置应该是：
```
ssl_certificate /etc/nginx/ssl/tangxinhao.online/cert.pem;
```

说明容器内的配置文件没有从主机同步。

## 排查步骤

### 步骤 1：检查主机上的配置文件

```bash
cat /home/hsk/nginx/conf.d/default.conf | grep -A 5 "listen 443"
```

确认主机上的配置是否正确。

### 步骤 2：检查 volume 映射

```bash
docker inspect hsk-nginx | grep -A 50 "Mounts" | grep nginx
```

确认 `/home/hsk/nginx/conf.d` 是否映射到 `/etc/nginx/conf.d`。

### 步骤 3：如果主机配置正确，但容器内不对

可能是容器创建时读取了旧的配置。需要：
1. 停止并删除容器
2. 重新创建容器

### 步骤 4：直接修改容器内的配置（临时方案）

如果 volume 映射有问题，可以临时修改容器内的配置：

```bash
docker exec hsk-nginx sh -c "sed -i 's|/etc/letsencrypt/live/tangxinhao.online/fullchain.pem|/etc/nginx/ssl/tangxinhao.online/cert.pem|g' /etc/nginx/conf.d/default.conf"
docker exec hsk-nginx sh -c "sed -i 's|/etc/letsencrypt/live/tangxinhao.online/privkey.pem|/etc/nginx/ssl/tangxinhao.online/cert.key|g' /etc/nginx/conf.d/default.conf"
```

但这是临时方案，因为配置文件是只读的（ro）。

## 正确的解决方案

检查主机上的配置文件，如果正确，重新创建容器：

```bash
cd /home/hsk

# 停止并删除容器
docker stop hsk-nginx
docker rm hsk-nginx

# 重新创建容器
docker run -d \
  --name hsk-nginx \
  --restart always \
  -p 80:80 \
  -p 443:443 \
  -v /home/hsk/nginx/nginx.conf:/etc/nginx/nginx.conf:ro \
  -v /home/hsk/nginx/conf.d:/etc/nginx/conf.d:ro \
  -v /home/hsk/ssl:/etc/nginx/ssl:ro \
  -v /home/hsk/certbot/www:/var/www/certbot:ro \
  -v /home/hsk/certbot/conf:/etc/letsencrypt:ro \
  -v /home/hsk/backend/media:/var/www/media:ro \
  -v /home/hsk/backend/static:/var/www/static:ro \
  --network hsk_hsk-network \
  nginx:alpine
```
