# 排查证书路径问题 - 详细步骤

## 当前问题

容器已重新创建，但证书文件仍然找不到：
```
ls: /etc/nginx/ssl/tangxinhao.online/: No such file or directory
```

## 排查步骤

### 步骤 1：检查容器内的 /etc/nginx/ssl/ 目录

```bash
docker exec hsk-nginx ls -la /etc/nginx/ssl/
```

**预期结果**：
- 如果看到 `tangxinhao.online` 目录，说明映射成功
- 如果提示 "No such file or directory"，说明整个 `/etc/nginx/ssl/` 目录都不存在

### 步骤 2：检查主机上的证书文件

```bash
ls -la /home/hsk/ssl/tangxinhao.online/
```

应该看到 `cert.pem` 和 `cert.key`。

### 步骤 3：检查 docker-compose 配置

```bash
cat docker-compose.prod.yml | grep -A 15 "nginx:"
```

确认有这一行：
```yaml
- ./ssl:/etc/nginx/ssl:ro
```

### 步骤 4：检查容器 volume 映射

```bash
docker inspect hsk-nginx | grep -A 20 "Mounts"
```

查看实际的 volume 映射情况。

## 可能的原因和解决方案

### 原因 1：容器内的 /etc/nginx/ssl/ 目录不存在

如果步骤 1 显示整个目录都不存在，可能是：
- volume 映射没有生效
- 需要手动创建目录

**解决方案**：
```bash
# 检查主机上的 ssl 目录
ls -la /home/hsk/ssl/

# 如果主机上存在，但容器内没有，可能是权限问题
# 尝试重新创建容器并检查日志
docker logs hsk-nginx
```

### 原因 2：路径映射问题

如果 `docker inspect` 显示的路径不对，需要检查：
- docker-compose 文件中的路径是相对路径 `./ssl`
- 确保在 `/home/hsk` 目录下执行 `docker compose` 命令

### 原因 3：权限问题

检查文件权限：
```bash
# 主机上
ls -la /home/hsk/ssl/tangxinhao.online/

# 确保文件可读
chmod 644 /home/hsk/ssl/tangxinhao.online/cert.pem
chmod 600 /home/hsk/ssl/tangxinhao.online/cert.key
```
