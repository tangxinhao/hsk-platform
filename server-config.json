{
  "server_info": {
    "host": "118.190.106.159",
    "project_path": "/home/hsk",
    "domain": "tangxinhao.online",
    "www_domain": "www.tangxinhao.online",
    "ssl_cert_path": "/home/hsk/ssl",
    "ssl_cert_file": "/home/hsk/ssl/tangxinhao.online/cert.pem",
    "ssl_key_file": "/home/hsk/ssl/tangxinhao.online/cert.key"
  },
  "database": {
    "host": "db",
    "port": 3306,
    "name": "hsk_schema",
    "user": "root",
    "password": "tangxinhao521",
    "charset": "utf8mb4",
    "collation": "utf8mb4_unicode_ci"
  },
  "django": {
    "secret_key": "your_django_secret_key_here",
    "settings_module": "hsk_project.settings_prod",
    "allowed_hosts": "tangxinhao.online,www.tangxinhao.online,localhost,118.190.106.159",
    "api_base_url": "https://tangxinhao.online"
  },
  "ports": {
    "nginx_http": 80,
    "nginx_https": 443,
    "mysql": 3306,
    "backend": 8000,
    "frontend": 80
  },
  "paths": {
    "media": "./backend/media",
    "static": "./backend/static",
    "ssl": "./ssl",
    "certbot_www": "./certbot/www",
    "certbot_conf": "./certbot/conf"
  },
  "docker": {
    "compose_file": "docker-compose.prod.yml",
    "network": "hsk_hsk-network",
    "services": {
      "backend": "hsk-backend",
      "frontend_user": "hsk-frontend-user",
      "frontend_admin": "hsk-frontend-admin",
      "nginx": "hsk-nginx",
      "mysql": "hsk-mysql"
    }
  },
  "deployment": {
    "git_repo": "https://github.com/tangxinhao/hsk-platform.git",
    "git_branch": "main",
    "swap_size": "2G",
    "swap_file": "/swapfile",
    "build_memory_limit": "1024",
    "node_options": "--max-old-space-size=1024"
  },
  "common_issues": {
    "database_permission_fix": "CREATE USER IF NOT EXISTS 'root'@'%' IDENTIFIED BY 'tangxinhao521'; GRANT ALL PRIVILEGES ON hsk_schema.* TO 'root'@'%' WITH GRANT OPTION; FLUSH PRIVILEGES;",
    "env_file_path": "/home/hsk/.env",
    "required_env_vars": [
      "DB_PASSWORD",
      "DB_NAME",
      "DB_USER",
      "SECRET_KEY",
      "ALLOWED_HOSTS",
      "API_BASE_URL"
    ]
  },
  "notes": {
    "last_updated": "2026-02-21",
    "known_issues": [
      "MySQL 8.0 需要使用 CREATE USER 而不是 GRANT ... IDENTIFIED BY",
      "重启容器不会重新读取 .env，需要重新创建容器",
      "服务器资源有限，需要启用交换空间避免卡死",
      "前端构建时 Node.js 内存限制为 1024MB，避免 OOM"
    ],
    "tips": [
      "使用 smart-deploy.sh 脚本可以自动处理大部分常见问题",
      "配置文件包含敏感信息，已添加到 .gitignore",
      "修改配置后，需要重新创建容器才能生效（不只是重启）"
    ]
  }
}